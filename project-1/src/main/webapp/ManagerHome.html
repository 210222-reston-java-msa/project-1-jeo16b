<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Financial Manager Home</title>

<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
	integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
	crossorigin="anonymous">

	
</head>
<body>

	<div id="nav-placeholder"></div>

	<div class="jumbotron">
			<h1 id="welcome">Welcome Manager!</h1></br>
			<h2 id="firstName">First Name: </h2>
			<h2 id="lastName">Last Name: </h2>
			<h2 id="username">Username: </h2></br>
			<h2 id="email">Email: </h2></br>	
	</div>
	
	<a href="manEditInfo.html">Edit Info</a>

		<script src="//code.jquery.com/jquery.min.js"></script>
		<script>
		$.get("ManagerNav.html", function(data){
			$("#nav-placeholder").replaceWith(data);
		});
		</script>
		
		<script>
			
		// capture the welcome element and modify it so that it says welcome + username
		let firstName = document.getElementById('firstName');
		let lastName = document.getElementById('lastName');
		let username = document.getElementById('username');
		let email = document.getElementById('email');
		
		//capture the userString by accessing the session
		let userString = sessionStorage.getItem('currentUser');

		// set up some logic
		// If the user is null...redirect them to the index.html page ("http://localhost:8080/EmployeeDBServlet/")
		//if(userString === null){
		//	window.location = "http://localhost:8080/project-1/";
		//}else{
			let currentUser = JSON.parse(userString);
			
			console.log(currentUser);
			
			if(currentUser != null){
				firstName.innerHTML = "First Name: " + currentUser.firstName;
				lastName.innerHTML = "Last Name: " + currentUser.lastName;
				username.innerHTML = "Username: " + currentUser.username;
				email.innerHTML = "Email: " + currentUser.email;
			} 
		//}
		
		//OTHERWISE...
			// we parse the user string, and set the textContent of welcome to welcome + currentUser.something
		
		function logout(){
			
			let xhr = new XMLHttpRequest();
			
			xhr.open("POST", "http://localhost:8080/project-1/logout");
			xhr.send();
			
			sessionStorage.removeItem('currentUser');
			window.location = "http://localhost:8080/project-1/";
			
		}
		
		</script>

</body>
</html>